<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>jQuery UI Example Page</title>
		<script type="text/javascript" src="./js/jquery-1.3.2.min.js"></script>
		<script type="text/javascript" src="./js/jquery-ui-1.7.2.custom.min.js"></script>
		<script type="text/javascript" src="./jpivot.js"></script>
		<link type="text/css" href="./css/redmond/jquery-ui-1.7.2.custom.css" rel="stylesheet" />	
		<script type="text/javascript">
var month_subst = ['янв','фев','мрт','апр','май','июн','июл','авг','сен','окт','ноя','дек'];
var data=[];
for (i=0;i<3;i++)
	for (j=0;j<3;j++)
		for (k=10;k<15;k++)
			for (n=1;n<15;n++)
					{
						rnd=Math.random()*100;
					if ( rnd > 50) continue;
					if (rnd > 60 )continue;
					 data.push(['s'+i,'b'+j,k,n,'s'+i+'-b'+j+'-q'+k+'-qn'+n]);
					}
			

	var data =[
	
["КИЕВ","КИЕВ Драйзера ул, 21","A","320.00","450.00","71.11"],
["КИЕВ","КИЕВ Драйзера ул, 8","A","327.00","450.00","72.67"],
["БОРИСПОЛЬ","БОРИСПОЛЬ Киевская тр, 76","A","371.00","450.00","82.44"],
["КИЕВ","КИЕВ Закревского ул, 61/2","B","308.00","450.00","68.44"],
["КИЕВ","КИЕВ Маяковского пр, 75/2","A","308.00","450.00","68.44"],
["КИЕВ","КИЕВ Радужная ул, 8","A","392.00","450.00","87.11"],
["КИЕВ","КИЕВ Стальского ул, 22/1","B","338.00","450.00","75.11"],
["СЛАВУТИЧ","СЛАВУТИЧ Привокзальная ул, 5","B","419.00","525.00","79.81"],
["КИЕВ","КИЕВ Карельский пер, 3","A","332.00","450.00","73.78"],
["КИЕВ","КИЕВ Лесной пр, 39","B","339.00","450.00","75.33"]
];	
var rows = [0,2];	
var cols = [1];
var data_col=3;	
var filter = []
var data_headers=["город","объект","TAG"]
	

$(document).ready(function()
	{
	$('#pv').jPivot({
			data:data,rows:rows,cols:cols,data_col:data_col,data_headers:data_headers
			,filter:filter
			,printValue:function(data_indexes)
					{
					if (data_indexes==undefined) return '--';
					var len =data_indexes.length 
					if (len==1) return this.data[data_indexes[0]][5]+'='+this.data[data_indexes[0]][3]+'/'+this.data[data_indexes[0]][4];
					var ball=0, max_ball=0;
					for (i=0;i < len; i++) 
							{
							ball += parseFloat(this.data[data_indexes[i]][3]);
							max_ball += parseFloat(this.data[data_indexes[i]][4]);
						  }
					return ball+'/'+max_ball;
					}
			,printKey:function(col,val)
					{
						/*
					if (col==2)
							return month_subst[val-1]
					else
						  return val
						  */
					return val;
					}	
			,getData:function(row,col,data_ptr)				
						{
						return data_ptr[row][4]+'='+data_ptr[row][2]+'/'+data_ptr[row][3]
						}
			});  	
		
	}
	);

			
		</script>
		<style>
			.pv_dialog {font-size:10px;}
			table.pv_table{border-collapse:collapse;border:1px solid red;}
			.pv_table td{border:1px solid green;}
			.pv_table th{border:1px solid silver;}
			.pv_key_header_filtered {color:green;}
			.pv_keys_placeholder {padding:0px;list-style-type: none; margin:0;}
			#pv_filter li, #pv_rowkeys_placeholder li {float:left;}	
			#pv_rowkeys_placeholder{padding-bottom:5px;}
			#pv_colkeys_placeholder{padding-bottom:1px;}
			#pv_filter {padding-bottom:5px;}
		</style>
	</head>
	<body>
		<hr>
		<div id='pv'></div>
		<hr>
		<div id='pv2'></div>
	</body>